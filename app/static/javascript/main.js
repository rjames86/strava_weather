(function(){var t,e,a,i,r,s,c,n,o,l,p,d;a=React.createFactory(React.createClass({displayName:"LoadingDots",propTypes:{thingToLoad:React.PropTypes.string},render:function(){return d.h1({className:"loader center"},"Loading "+this.props.thingToLoad,d.span({},"."),d.span({},"."),d.span({},"."))}})),d=React.DOM,l=React.createElement,o=React.createFactory(React.createClass({displayName:"Weather",propTypes:{activity:React.PropTypes.object},getInitialState:function(){return{loading:!1,weather:null}},degreesToDirection:function(t){var e,a;return e=t-11.25,a=function(){switch(e){case 0:return"NNE";case 1:return"NE";case 2:return"ENE";case 3:return"E";case 4:return"ESE";case 5:return"SE";case 6:return"SSE";case 7:return"S";case 8:return"SSW";case 9:return"SW";case 10:return"WSW";case 11:return"W";case 12:return"WNW";case 13:return"NW";case 14:return"NNW";case 15:return"N";default:return"unknown"}},e<0&&(e=360+e),e/=22.5,e=Math.floor(e),e=a(e)},loadTheWeather:function(){var t;return t=new Skycons({color:"#FC4C02"}),t.remove("weather_icon"),this.setState({loading:!0}),$.ajax({url:"/strava/activity/"+this.props.activity.id+"/weather_at_start",success:function(e){return function(a){var i;return i=a.data,e.setState({loading:!1,weather:i}),t.add("weather_icon",i.icon),t.play()}}(this)})},componentDidMount:function(){return this.loadTheWeather()},componentDidUpdate:function(t,e){var a;if(this.props.activity.id!==(null!=(a=t.activity)?a.id:void 0))return this.loadTheWeather()},render:function(){return d.div({},this.state.loading?a({thingToLoad:"Weather"}):this.state.weather?d.div({className:"weather-widget__content center"},d.canvas({id:"weather_icon",width:128,height:128},""),d.ul({className:"weather-widget__description"},d.li({},"Temperature: "+this.state.weather.temperature+String.fromCharCode(8457)),d.li({},"Windspeed: "+this.state.weather.windSpeed+" "+this.degreesToDirection(this.state.weather.windBearing)))):d.h1({},"Weather widget"))}})),a=React.createFactory(React.createClass({displayName:"LoadingDots",propTypes:{thingToLoad:React.PropTypes.string},render:function(){return d.h1({className:"loader center"},"Loading "+this.props.thingToLoad,d.span({},"."),d.span({},"."),d.span({},"."))}})),d=React.DOM,l=React.createElement,n=React.createFactory(React.createClass({displayName:"StravaMap",defaultPublicToken:"pk.eyJ1IjoicmphbWVzODYiLCJhIjoiY2ltam53d2F5MDBzZnY4a2cyaWR4Y3pnMyJ9.SM84_1rqm7WiwAl4uO7RIw",propTypes:{activity:React.PropTypes.object},decodePolyline:function(){return polyline.decode(this.props.activity.map.summary_polyline)},componentDidUpdate:function(t,e){var a;if(this.props.activity.id!==(null!=(a=t.activity)?a.id:void 0))return this.polyline.remove(),this.addLayer()},addLayer:function(){return this.polyline=L.polyline(this.decodePolyline(),{color:"red"}).addTo(mymap),mymap.fitBounds(this.polyline.getBounds())},componentDidMount:function(){return window.mymap=L.map("map").setView([37.76289,-122.43468],13),L.tileLayer("https://api.mapbox.com/styles/v1/mapbox/streets-v9/tiles/256/{z}/{x}/{y}?access_token="+this.defaultPublicToken,{maxZoom:18,accessToken:this.defaultPublicToken}).addTo(mymap),this.addLayer()},render:function(){return this.props.activity?d.div({className:"map-container"},d.div({id:"map",style:{position:"absolute",top:0,bottom:0,width:"100%"}})):a({thingToLoad:"Map"})}})),d=React.DOM,l=React.createElement,s=React.createFactory(React.createClass({displayName:"RideInfo",propTypes:{activity:React.PropTypes.object},metersToMiles:function(t){var e;return e=t/1609.344,Math.round(100*e)/100},metersToFeet:function(t){var e;return e=5280*this.metersToMiles(t),Math.round(100*e)/100},secondsToHours:function(t){var e,a,i;return i=parseInt(t,10),e=Math.floor(i/3600),a=Math.floor((i-3600*e)/60),t=i-3600*e-60*a,e<10&&(e="0"+e),a<10&&(a="0"+a),t<10&&(t="0"+t),e+":"+a+":"+t},kilometersToMiles:function(t){var e;return e=t/.44704,Math.round(100*e)/100},isoToDate:function(t){var e;return e=new Date(Date.parse(t)),e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()},render:function(){return d.div({className:"row"},d.div({className:"col-md-12"},d.h2({className:"center"},this.props.activity.name)),d.div({className:"col-md-12 center"},d.ul({className:"rideinfo"},d.li({},"Start Time: "+this.isoToDate(this.props.activity.start_date_local)),d.li({},"Distance: "+this.metersToMiles(this.props.activity.distance)+" mi"),d.li({},"Elapsed Time: "+this.secondsToHours(this.props.activity.elapsed_time))),d.ul({className:"rideinfo"},d.li({},"Elevation Gain: "+this.metersToFeet(this.props.activity.total_elevation_gain)+" ft"),d.li({},"Max Speed: "+this.kilometersToMiles(this.props.activity.max_speed)+" mph"),this.props.activity.gear?d.li({},"Gear: "+this.props.activity.gear.name):void 0)))}})),d=React.DOM,l=React.createElement,r=React.createFactory(React.createClass({displayName:"MainContent",propTypes:{selectedActivity:React.PropTypes.object},render:function(){return this.props.selectedActivity?d.div({},d.div({className:"row weather-rideinfo-container"},d.div({className:"col-md-6"},this.props.selectedActivity?o({activity:this.props.selectedActivity}):void 0),d.div({className:"col-md-6 strava-ride-info"},this.props.selectedActivity?s({activity:this.props.selectedActivity}):void 0)),d.div({className:"row strava-map"},d.div({className:"col-md-12"},this.props.selectedActivity?n({activity:this.props.selectedActivity}):void 0))):d.h1({className:"center"},"Select an activity to get started")}})),a=React.createFactory(React.createClass({displayName:"LoadingDots",propTypes:{thingToLoad:React.PropTypes.string},render:function(){return d.h1({className:"loader center"},"Loading "+this.props.thingToLoad,d.span({},"."),d.span({},"."),d.span({},"."))}})),d=React.DOM,l=React.createElement,p=React.createFactory(React.createClass),e=React.createFactory(React.createClass({displayName:"Activity",propTypes:{activity:React.PropTypes.object,onSelectActivity:React.PropTypes.func,selectedActivity:React.PropTypes.object},metersToMiles:function(t){var e;return e=t/1609.344,Math.round(100*e)/100},isoToDate:function(t){var e;return e=new Date(Date.parse(t)),e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()},selectActivity:function(t){return $.ajax({url:"/strava/activity/"+t.id,success:function(t){return function(e){return t.props.onSelectActivity(e.data)}}(this)})},render:function(){var t,e;return t=this.props.activity.id===(null!=(e=this.props.selectedActivity)?e.id:void 0)?"active":"",d.div({className:"list-group"},d.a({className:"list-group-item "+t,onClick:function(t){return function(){return t.selectActivity(t.props.activity)}}(this)},d.h4({className:"list-group-item-heading"},this.props.activity.name),d.p({className:"list-group-item-text"},"Start: "+this.isoToDate(this.props.activity.start_date)),d.p({className:"list-group-item-text"},"Type: "+this.props.activity.type),d.p({className:"list-group-item-text"},"Distance: "+this.metersToMiles(this.props.activity.distance)+" miles")))}})),t=React.createFactory(React.createClass({displayName:"Activities",getInitialState:function(){return{data:null}},componentDidMount:function(){return $.ajax({url:"/strava/activities",success:function(t){return function(e){return t.setState({data:e.data})}}(this)})},componentDidUpdate:function(){return $(".activities").css({height:$(window).innerHeight()})},render:function(){var t;return this.state.data?d.div({className:"activities"},function(){var a,i,r,s;for(r=this.state.data,s=[],a=0,i=r.length;a<i;a++)t=r[a],s.push(e({activity:t,key:t.id,onSelectActivity:this.props.onSelectActivity,selectedActivity:this.props.selectedActivity}));return s}.call(this)):a({thingToLoad:"Activities"})}})),d=React.DOM,l=React.createElement,p=React.createFactory(React.createClass),c=React.createFactory(React.createClass({displayName:"Sidebar",propTypes:{onSelectActivity:React.PropTypes.func,selectedActivity:React.PropTypes.object},render:function(){return t({onSelectActivity:this.props.onSelectActivity,selectedActivity:this.props.selectedActivity})}})),d=React.DOM,l=React.createElement,i=React.createClass({displayName:"Main",getInitialState:function(){return{activity:null}},onSelectActivity:function(t){return this.setState({activity:t})},render:function(){return d.div({className:"row"},d.div({className:"col-md-2 col-sm-2"},c({onSelectActivity:this.onSelectActivity,selectedActivity:this.state.activity})),d.div({className:"col-md-10 col-sm-10"},r({selectedActivity:this.state.activity})))}}),$(function(){var t;return t=document.getElementById("react-content"),ReactDOM.render(l(i,null,null),t)})}).call(this);